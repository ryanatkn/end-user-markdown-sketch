var xt=o=>{throw TypeError(o)};var Ye=(o,e,a)=>e.has(o)||xt("Cannot "+a);var n=(o,e,a)=>(Ye(o,e,"read from private field"),a?a.call(o):e.get(o)),be=(o,e,a)=>e.has(o)?xt("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(o):e.set(o,a),S=(o,e,a,r)=>(Ye(o,e,"write to private field"),r?r.call(o,a):e.set(o,a),a),i=(o,e,a)=>(Ye(o,e,"access private method"),a);var W=(o,e,a,r)=>({set _(l){S(o,e,l,a)},get _(){return n(o,e,r)}});import{l as bs,a as u,t as q,j as L,k as Pe,b as X}from"../chunks/disclose-version.B6wxUrlr.js";import{h as D,d as nt,aq as Ot,g as Nt,ar as ys,as as $e,i as Ee,q as ws,j as ze,x as Tt,$ as Mt,T as At,aa as Lt,at as jt,G as Ge,k as Ue,a4 as ks,a1 as xs,E as Ts,l as Ms,ac as As,K as Ft,J as St,C as Ls,au as at,av as js,r as Fs,p as we,t as G,a as ke,f as j,B as E,c as m,b as d,Y,aw as P,ap as it,s as h}from"../chunks/runtime.l6WfSkNZ.js";import{s as Et,c as Ht,h as Ss,a as rt,t as Es,P as It,b as Bt,L as et,d as Hs,M as Is,H as Cs,e as qe,i as Re,f as qs}from"../chunks/components.Dg2NWLUi.js";import{a as Ws,b as Ze,r as Os,s as Ns}from"../chunks/attributes.C54TMm--.js";import{b as Bs}from"../chunks/paths.CAN7Evbo.js";import{p as ot,i as I,s as Ps}from"../chunks/index-client.DD2MPsOr.js";import{c as zs}from"../chunks/svelte-component.0wOR9VZC.js";const tt=0,Be=1,st=2;function Gs(o,e,a,r,l){D&&nt();var c=o,v=Ot(),_=xs,f,p,g,y,k=(v?Tt:Mt)(void 0),b=(v?Tt:Mt)(void 0),A=!1;function T(x,F){A=!0,F&&(At(M),Lt(M),jt(_)),x===tt&&a&&(p?Ge(p):p=Ee(()=>a(c))),x===Be&&r&&(g?Ge(g):g=Ee(()=>r(c,k))),x===st&&l&&(y?Ge(y):y=Ee(()=>l(c,b))),x!==tt&&p&&Ue(p,()=>p=null),x!==Be&&g&&Ue(g,()=>g=null),x!==st&&y&&Ue(y,()=>y=null),F&&(jt(null),Lt(null),At(null),ks())}var M=Nt(()=>{if(f!==(f=e())){if(ys(f)){var x=f;A=!1,x.then(F=>{x===f&&($e(k,F),T(Be,!0))},F=>{if(x===f)throw $e(b,F),T(st,!0),b.v}),D?a&&(p=Ee(()=>a(c))):ws(()=>{A||T(tt,!0)})}else $e(k,f),T(Be,!1);return()=>f=null}});D&&(c=ze)}function Ct(o,e,a,r,l,c){let v=D;D&&nt();var _,f,p=null;D&&ze.nodeType===1&&(p=ze,nt());var g=D?ze:o,y,k=Ht;Nt(()=>{const b=e()||null;var A=b==="svg"?at:null;if(b!==_){var T=Ht;Et(k),y&&(b===null?Ue(y,()=>{y=null,f=null}):b===f?Ge(y):js(y)),b&&b!==f&&(y=Ee(()=>{if(p=D?p:A?document.createElementNS(A,b):document.createElement(b),bs(p,p),r){var M=D?Ms(p):p.appendChild(As());D&&(M===null?Ft(!1):St(M)),r(p,M)}Ls.nodes_end=p,g.before(p)})),_=b,_&&(f=_),Et(T)}},Ts),v&&(Ft(!0),St(g))}function Us(o,e,a,r=a){o.addEventListener(e,a);const l=o.__on_r;l?o.__on_r=()=>{l(),r()}:o.__on_r=r,Ws()}function Ds(o,e,a=e){var r=Ot();Us(o,"input",()=>{var l=qt(o)?Wt(o.value):o.value;a(l),r&&l!==(l=e())&&(o.value=l??"")}),Fs(()=>{var l=e();if(D&&o.defaultValue!==o.value){a(o.value);return}qt(o)&&l===Wt(o.value)||o.type==="date"&&!l&&!o.value||l!==o.value&&(o.value=l??"")})}function qt(o){var e=o.type;return e==="number"||e==="range"}function Wt(o){return o===""?null:+o}(function(o){o.languages.typescript=o.languages.extend("javascript",{"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|type)\s+)(?!keyof\b)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?:\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>)?/,lookbehind:!0,greedy:!0,inside:null},builtin:/\b(?:Array|Function|Promise|any|boolean|console|never|number|string|symbol|unknown)\b/}),o.languages.typescript.keyword.push(/\b(?:abstract|declare|is|keyof|readonly|require)\b/,/\b(?:asserts|infer|interface|module|namespace|type)\b(?=\s*(?:[{_$a-zA-Z\xA0-\uFFFF]|$))/,/\btype\b(?=\s*(?:[\{*]|$))/),delete o.languages.typescript.parameter,delete o.languages.typescript["literal-property"];var e=o.languages.extend("typescript",{});delete e["class-name"],o.languages.typescript["class-name"].inside=e,o.languages.insertBefore("typescript","function",{decorator:{pattern:/@[$\w\xA0-\uFFFF]+/,inside:{at:{pattern:/^@/,alias:"operator"},function:/^[\s\S]+/}},"generic-function":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>(?=\s*\()/,greedy:!0,inside:{function:/^#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*/,generic:{pattern:/<[\s\S]+/,alias:"class-name",inside:e}}}}),o.languages.ts=o.languages.typescript})(Prism);var Rs=q("<pre><code><!></code></pre>");function te(o,e){we(e,!0);const a=ot(e,"lang",3,"svelte"),r=ot(e,"inline",3,!1),l=Y(()=>a()===null?null:It.languages[a()]),c=Y(()=>E(l)===null?null:e.content&&It.highlight(e.content,E(l),a())),v=Y(()=>E(c)??e.content);var _=Rs();let f;var p=m(_);let g;var y=m(p);I(y,()=>e.children,k=>{var b=L(),A=j(b);rt(A,()=>e.children,()=>E(v)),u(k,b)},k=>{var b=L(),A=j(b);I(A,()=>E(c)!==null,T=>{var M=L(),x=j(M);Ss(x,()=>E(c),!1,!1),u(T,M)},T=>{var M=Pe();G(()=>X(M,e.content)),u(T,M)},!0),u(k,b)}),d(p),d(_),G(()=>{f=Ze(_,f,{...e.pre_attrs},"svelte-1a6bj2n"),Es(_,"inline",r()),g=Ze(p,g,{...e.code_attrs},"svelte-1a6bj2n")}),u(o,_),ke()}const Pt=new Set(["class","href","src","srcset","alt","title","name","width","height"]),Zs=(o,e=Pt)=>{let a;if("attributes"in o)for(const r of o.attributes){const{value:l}=r;if(o.type==="Component"||e.has(r.name)){let c="";for(const v of l)c+=v.content;c&&((a??(a=Object.create(null)))[r.name]=c)}}return a};var Vs=q('<code class="error_text"> </code>'),Js=q("<code> </code>"),Ks=q("<pre><code> </code></pre>"),Xs=q("<strong><!></strong>"),Qs=q("<em><!></em>"),Ys=q("<blockquote><!></blockquote>"),$s=q("<li><!></li>"),en=q("<ul></ul>"),tn=q('<span class="error_text"> </span>');function zt(o,e){we(e,!0);const a=(f,p=it)=>{var g=L(),y=j(g);qe(y,17,p,Re,(k,b)=>{zt(k,{get view(){return E(b)}})}),u(f,g)},r=Bt.get(),l=Y(()=>e.view.type==="Component"&&e.view.name in r?r[e.view.name]:null),c=Y(()=>Zs(e.view));var v=L(),_=j(v);I(_,()=>e.view.type==="Component",f=>{var p=L(),g=j(p);I(g,()=>E(l),y=>{var k=L(),b=j(k);Gs(b,()=>E(l),A=>{qs(A,{})},(A,T)=>{var M=L(),x=j(M);zs(x,()=>E(T),(F,C)=>{C(F,Ps(()=>E(c),{children:(N,z)=>{var B=L(),R=j(B);I(R,()=>e.view.children,U=>{a(U,()=>e.view.children)}),u(N,B)},$$slots:{default:!0}}))}),u(A,M)}),u(y,k)},y=>{var k=Vs(),b=m(k);d(k),G(()=>X(b,`<${e.view.name??""} />`)),u(y,k)}),u(f,p)},f=>{var p=L(),g=j(p);I(g,()=>e.view.type==="Element",y=>{var k=L(),b=j(k);I(b,()=>e.view.self_closing,A=>{var T=L(),M=j(T);Ct(M,()=>e.view.name,!1,(x,F)=>{let C;G(()=>C=Ze(x,C,{...E(c)},void 0,x.namespaceURI===at,x.nodeName.includes("-")))}),u(A,T)},A=>{var T=L(),M=j(T);I(M,()=>e.view.name==="a",x=>{var F=Y(()=>{var C;return(C=E(c))==null?void 0:C.href});et(x,{get href(){return E(F)},get attrs(){return E(c)},children:(C,N)=>{a(C,()=>e.view.children)},$$slots:{default:!0}})},x=>{var F=L(),C=j(F);Ct(C,()=>e.view.name,!1,(N,z)=>{let B;G(()=>B=Ze(N,B,{...E(c)},void 0,N.namespaceURI===at,N.nodeName.includes("-"))),a(z,()=>e.view.children)}),u(x,F)},!0),u(A,T)}),u(y,k)},y=>{var k=L(),b=j(k);I(b,()=>e.view.type==="Text",A=>{var T=Pe();G(()=>X(T,e.view.content)),u(A,T)},A=>{var T=L(),M=j(T);I(M,()=>e.view.type==="Code",x=>{var F=Js(),C=m(F,!0);d(F),G(()=>X(C,e.view.content)),u(x,F)},x=>{var F=L(),C=j(F);I(C,()=>e.view.type==="Code_Block",N=>{var z=Ks(),B=m(z),R=m(B,!0);d(B),d(z),G(()=>{Hs(B,e.view.language),X(R,e.view.content)}),u(N,z)},N=>{var z=L(),B=j(z);I(B,()=>e.view.type==="Bold",R=>{var U=Xs(),xe=m(U);a(xe,()=>e.view.children),d(U),u(R,U)},R=>{var U=L(),xe=j(U);I(xe,()=>e.view.type==="Italic",ie=>{var Z=Qs(),Te=m(Z);a(Te,()=>e.view.children),d(Z),u(ie,Z)},ie=>{var Z=L(),Te=j(Z);I(Te,()=>e.view.type==="Mention",re=>{Is(re,{get name(){return e.view.name}})},re=>{var Me=L(),Ve=j(Me);I(Ve,()=>e.view.type==="Hashtag",pe=>{Cs(pe,{get name(){return e.view.name}})},pe=>{var We=L(),Ae=j(We);I(Ae,()=>e.view.type==="Absolute_Link"||e.view.type==="Relative_Link"||e.view.type==="Global_Link",me=>{et(me,{get href(){return e.view.href},children:(oe,Le)=>{P();var V=Pe();G(()=>X(V,e.view.href)),u(oe,V)},$$slots:{default:!0}})},me=>{var oe=L(),Le=j(oe);I(Le,()=>e.view.type==="Markdown_Link",V=>{et(V,{get href(){return e.view.href},children:(le,je)=>{a(le,()=>e.view.text)},$$slots:{default:!0}})},V=>{var le=L(),je=j(le);I(je,()=>e.view.type==="Expression",Fe=>{var J=Pe();G(()=>X(J,e.view.content)),u(Fe,J)},Fe=>{var J=L(),Oe=j(J);I(Oe,()=>e.view.type==="Blockquote",ce=>{var $=Ys(),ve=m($);a(ve,()=>e.view.children),d($),u(ce,$)},ce=>{var $=L(),ve=j($);I(ve,()=>e.view.type==="List",fe=>{var K=en();qe(K,21,()=>e.view.items,Re,(he,Ne)=>{var _e=$s(),Je=m(_e);a(Je,()=>E(Ne).children),d(_e),u(he,_e)}),d(K),u(fe,K)},fe=>{var K=tn(),he=m(K);d(K),G(()=>X(he,`Unknown node type: ${e.view.type??""}`)),u(fe,K)},!0),u(ce,$)},!0),u(Fe,J)},!0),u(V,le)},!0),u(me,oe)},!0),u(pe,We)},!0),u(re,Me)},!0),u(ie,Z)},!0),u(R,U)},!0),u(N,z)},!0),u(x,F)},!0),u(A,T)},!0),u(y,k)},!0),u(f,p)}),u(o,v),ke()}const sn=o=>new lt(o).parse();var s,Q,ye,ue,t,Gt,He,ct,ht,Ut,Dt,dt,Rt,Ie,Zt,H,w,Vt,Jt,Kt,Xt,ut,Qt,Yt,$t,es,ts,ss,ns,as,is,rs,pt,os,ls,cs,mt,hs,ds,vt,us,De,ps,ft,ms,se,ne;const Ce=class Ce{constructor(e){be(this,t);be(this,s,0);be(this,Q,"");be(this,ye,0);be(this,ue,[]);this.template=e}parse(){for(S(this,ue,[]);n(this,s)<this.template.length;){const e=i(this,t,ct).call(this);e.type==="Text"?i(this,t,Gt).call(this,e.content,e.start):(i(this,t,He).call(this),n(this,ue).push(e))}return i(this,t,He).call(this),n(this,ue)}};s=new WeakMap,Q=new WeakMap,ye=new WeakMap,ue=new WeakMap,t=new WeakSet,Gt=function(e,a){n(this,Q)===""&&S(this,ye,a),S(this,Q,n(this,Q)+e)},He=function(){n(this,Q)!==""&&(n(this,ue).push({type:"Text",content:n(this,Q),start:n(this,ye),end:n(this,ye)+n(this,Q).length}),S(this,Q,""))},ct=function(){return i(this,t,dt).call(this)?(i(this,t,He).call(this),i(this,t,ht).call(this,0)):i(this,t,w).call(this,"> ")?i(this,t,ms).call(this):i(this,t,Jt).call(this)?i(this,t,Kt).call(this):i(this,t,w).call(this,"`")?i(this,t,Xt).call(this):i(this,t,w).call(this,"*")?i(this,t,Qt).call(this):i(this,t,w).call(this,"_")?i(this,t,Yt).call(this):i(this,t,w).call(this,"@")?i(this,t,$t).call(this):i(this,t,w).call(this,"#")?i(this,t,es).call(this):i(this,t,w).call(this,"[")?i(this,t,ts).call(this):i(this,t,ps).call(this)?i(this,t,ns).call(this):i(this,t,w).call(this,"/")?i(this,t,as).call(this):i(this,t,w).call(this,"./")?i(this,t,is).call(this):i(this,t,w).call(this,"<")?i(this,t,rs).call(this):i(this,t,w).call(this,"{")?i(this,t,cs).call(this):i(this,t,Ut).call(this)},ht=function(e,a=""){const r=n(this,s),l=[];let c=e===0?"":a,v=r;for(i(this,t,He).call(this);n(this,s)<this.template.length;){const{indent_chars:_,effective_indent:f}=i(this,t,Ie).call(this);if(i(this,t,Rt).call(this,f,e)){e>0&&c===a&&(c+=_.slice(a.length));const p=n(this,s);i(this,t,Zt).call(this),i(this,t,Dt).call(this);const g=n(this,s);let y=this.template.indexOf(`
`,n(this,s));y===-1&&(y=this.template.length);const k=this.template.slice(n(this,s),y);S(this,s,y);const A=new Ce(k).parse();A.forEach(M=>i(this,t,ne).call(this,M,g));const T={type:"List_Item",children:A,start:p,end:n(this,s)};if(l.push(T),i(this,t,w).call(this,`
`)){i(this,t,H).call(this,`
`),v=n(this,s);const{effective_indent:M}=i(this,t,Ie).call(this);if(M>f){const x=i(this,t,ht).call(this,M,c);T.children.push(x),v=x.end}else if(M<f)break}else{v=n(this,s);break}}else break}return{type:"List",start:r,end:v,items:l,indent_level:i(this,t,Vt).call(this,e),indent_text:c}},Ut=function(){const e=n(this,s);let a="";for(;n(this,s)<this.template.length&&!i(this,t,dt).call(this);){const r=this.template[n(this,s)];if(/[`*_@#<{[]/.test(r)||this.template.startsWith("http://",n(this,s))||this.template.startsWith("https://",n(this,s))||this.template.startsWith("//",n(this,s))||this.template.startsWith("./",n(this,s))||r==="/")break;a+=r,W(this,s)._++}return{type:"Text",content:a,start:e,end:n(this,s)}},Dt=function(){if(this.template[n(this,s)]==="-"||this.template[n(this,s)]==="+"||this.template[n(this,s)]==="*")S(this,s,n(this,s)+2);else if(/\d/.test(this.template[n(this,s)])){for(;/\d/.test(this.template[n(this,s)]);)W(this,s)._++;(this.template[n(this,s)]==="."||this.template[n(this,s)]===")")&&S(this,s,n(this,s)+2)}},dt=function(){return(n(this,s)===0||this.template[n(this,s)-1]===`
`)&&(this.template.startsWith("- ",n(this,s))||this.template.startsWith("+ ",n(this,s))||this.template.startsWith("* ",n(this,s))||/^\d+\.( |\))/.test(this.template.slice(n(this,s))))},Rt=function(e,a){if(e<a)return!1;const r=n(this,s)+i(this,t,Ie).call(this).indent_chars.length;return this.template.startsWith("- ",r)||this.template.startsWith("+ ",r)||this.template.startsWith("* ",r)||/^\d+\.( |\))/.test(this.template.slice(r))},Ie=function(){let e="",a=0;for(;n(this,s)+e.length<this.template.length;){const r=this.template[n(this,s)+e.length];if(r===" ")e+=" ",a+=1;else if(r==="	")e+="	",a+=2;else break}return{indent_chars:e,effective_indent:a}},Zt=function(){const{indent_chars:e}=i(this,t,Ie).call(this);S(this,s,n(this,s)+e.length)},H=function(e){if(i(this,t,w).call(this,e))S(this,s,n(this,s)+e.length);else throw new Error(`Expected "${e}" at index ${n(this,s)}`)},w=function(e){return this.template.startsWith(e,n(this,s))},Vt=function(e){return Math.floor(e/2)},Jt=function(){return i(this,t,ft).call(this,"`")>=3},Kt=function(){const e=n(this,s),a=i(this,t,us).call(this,"`");let r=null,l="",c="",v="";const _=e+a.length,f=this.template.indexOf(`
`,_),p=this.template.indexOf(a,_);f!==-1&&(p===-1||f<p)?(r=this.template.slice(_,f).trim()||null,S(this,s,f+1),l=`
`):S(this,s,_);const g=this.template.indexOf(a,n(this,s));if(g===-1)c=this.template.slice(n(this,s)),S(this,s,this.template.length);else{const k=this.template.slice(n(this,s),g);S(this,s,g+a.length);const b=/^(\s*)([\s\S]*?)(\s*)$/.exec(k);b?(l+=b[1],c=b[2],v=b[3]):c=k}const y=c.trim()===""&&a.length>=6&&a.length%2===0?a[0].repeat(a.length/2):a;return{type:"Code_Block",content:c,language:r,fence:y,leading_whitespace:l,trailing_whitespace:v,start:e,end:n(this,s)}},Xt=function(){const e=n(this,s);i(this,t,H).call(this,"`");const a=n(this,s),r=this.template.indexOf("`",n(this,s));if(r===-1)return S(this,s,this.template.length),{type:"Text",content:this.template.slice(e),start:e,end:n(this,s)};const l=this.template.slice(a,r);return S(this,s,r+1),{type:"Code",content:l,start:e,end:n(this,s)}},ut=function(e,a){const r=n(this,s),l=i(this,t,ft).call(this,e);if(l===1){i(this,t,H).call(this,e);const v=i(this,t,mt).call(this,_=>_===e);if(i(this,t,w).call(this,e))return i(this,t,H).call(this,e),{type:a,children:v,start:r,end:n(this,s)};{S(this,s,r);const _=this.template[n(this,s)];return W(this,s)._++,{type:"Text",content:_,start:r,end:n(this,s)}}}const c=e.repeat(l);return S(this,s,n(this,s)+l),{type:"Text",content:c,start:r,end:n(this,s)}},Qt=function(){return i(this,t,ut).call(this,"*","Bold")},Yt=function(){return i(this,t,ut).call(this,"_","Italic")},$t=function(){const e=n(this,s);return i(this,t,H).call(this,"@"),{type:"Mention",name:i(this,t,vt).call(this),start:e,end:n(this,s)}},es=function(){const e=n(this,s);return i(this,t,H).call(this,"#"),{type:"Hashtag",name:i(this,t,vt).call(this),start:e,end:n(this,s)}},ts=function(){const e=n(this,s);i(this,t,H).call(this,"[");let a="",r=1;for(;n(this,s)<this.template.length;){const l=this.template[n(this,s)];if(W(this,s)._++,a+=l,l==="[")r++;else if(l==="]"){if(r--,r===0&&i(this,t,w).call(this,"("))return i(this,t,H).call(this,"("),i(this,t,ss).call(this,e,a.slice(0,-1));if(r===0)return{type:"Text",content:a,start:e,end:n(this,s)}}}return{type:"Text",content:a,start:e,end:n(this,s)}},ss=function(e,a){const r=this.template.indexOf(")",n(this,s));if(r===-1)return S(this,s,this.template.length),{type:"Text",content:`[${a}(`,start:e,end:n(this,s)};const l=this.template.slice(n(this,s),r);S(this,s,r+1);const c=new Ce(a).parse();return c.forEach(v=>i(this,t,ne).call(this,v,e+1)),{type:"Markdown_Link",text:c,href:l,start:e,end:n(this,s)}},ns=function(){const e=n(this,s);let a;if(i(this,t,w).call(this,"http://")||i(this,t,w).call(this,"https://")||i(this,t,w).call(this,"//"))return a=i(this,t,se).call(this,r=>/[\s,<>]/.test(r)),{type:"Global_Link",href:a,start:e,end:n(this,s)};{const r=this.template[n(this,s)];return W(this,s)._++,{type:"Text",content:r,start:e,end:n(this,s)}}},as=function(){const e=n(this,s);if(i(this,t,w).call(this,"/"))return i(this,t,H).call(this,"/"),{type:"Absolute_Link",href:"/"+i(this,t,se).call(this,r=>/[\s,<>]/.test(r)),start:e,end:n(this,s)};{const a=this.template[n(this,s)];return W(this,s)._++,{type:"Text",content:a,start:e,end:n(this,s)}}},is=function(){const e=n(this,s);if(i(this,t,w).call(this,"./"))return{type:"Relative_Link",href:i(this,t,se).call(this,r=>/[\s,<>]/.test(r)),start:e,end:n(this,s)};{const a=this.template[n(this,s)];return W(this,s)._++,{type:"Text",content:a,start:e,end:n(this,s)}}},rs=function(){const e=n(this,s);i(this,t,H).call(this,"<");const a=i(this,t,ds).call(this),r=/^[A-Z]/.test(a),l=i(this,t,ls).call(this),c=i(this,t,os).call(this);let v=!1,_=null;if(i(this,t,w).call(this,"/>"))v=!0,_=c||null,i(this,t,H).call(this,"/>");else if(i(this,t,w).call(this,">"))i(this,t,H).call(this,">");else return i(this,t,pt).call(this,e);if(v)return{type:r?"Component":"Element",name:a,attributes:l,children:[],start:e,end:n(this,s),self_closing:v,self_closing_space:_,original_syntax:"html"};{const f=`</${a}>`;if(this.template.indexOf(f,n(this,s))!==-1){const g=i(this,t,mt).call(this,()=>this.template.startsWith(f,n(this,s)));return i(this,t,H).call(this,f),{type:r?"Component":"Element",name:a,attributes:l,children:g,start:e,end:n(this,s),self_closing:!1,self_closing_space:null,original_syntax:"html"}}else return i(this,t,pt).call(this,e)}},pt=function(e){return{type:"Text",content:this.template.slice(e,n(this,s)),start:e,end:n(this,s)}},os=function(){let e="";for(;n(this,s)<this.template.length&&/\s/.test(this.template[n(this,s)]);)e+=this.template[n(this,s)],W(this,s)._++;return e},ls=function(){const e=[];for(;!(i(this,t,w).call(this,">")||i(this,t,w).call(this,"/>"));){const a=n(this,s);if(i(this,t,De).call(this),i(this,t,w).call(this,">")||i(this,t,w).call(this,"/>")){S(this,s,a);break}const r=n(this,s),l=i(this,t,hs).call(this);if(!l)break;let c=[];if(i(this,t,De).call(this),i(this,t,w).call(this,"=")){i(this,t,H).call(this,"="),i(this,t,De).call(this);const v=this.template[n(this,s)];if(v==='"'||v==="'"){i(this,t,H).call(this,v);const _=n(this,s),f=i(this,t,se).call(this,g=>g===v),p=n(this,s);i(this,t,H).call(this,v),c=[{type:"Text",content:f,start:_,end:p}]}else{const _=n(this,s),f=i(this,t,se).call(this,g=>/[\s/>]/.test(g)),p=n(this,s);c=[{type:"Text",content:f,start:_,end:p}]}}e.push({type:"Attribute",name:l,value:c,start:r,end:n(this,s),parent:null})}return e},cs=function(){const e=n(this,s);i(this,t,H).call(this,"{");const a=i(this,t,se).call(this,r=>r==="}");return i(this,t,H).call(this,"}"),{type:"Expression",content:a,start:e,end:n(this,s)}},mt=function(e){const a=[];for(;n(this,s)<this.template.length&&!e(this.template[n(this,s)]);){const r=i(this,t,ct).call(this);if(r.type==="Text"&&a.length>0&&a[a.length-1].type==="Text"){const l=a[a.length-1];l.content+=r.content,l.end=r.end}else a.push(r)}return a},hs=function(){const e=n(this,s);for(;n(this,s)<this.template.length&&!/[\s=/>]/.test(this.template[n(this,s)]);)W(this,s)._++;return this.template.slice(e,n(this,s))},ds=function(){const e=n(this,s);for(;n(this,s)<this.template.length&&!/[\s/>]/.test(this.template[n(this,s)]);)W(this,s)._++;return this.template.slice(e,n(this,s))},vt=function(){const e=n(this,s);for(;n(this,s)<this.template.length&&/[a-zA-Z0-9_]/.test(this.template[n(this,s)]);)W(this,s)._++;return this.template.slice(e,n(this,s))},us=function(e){const a=n(this,s);for(;n(this,s)<this.template.length&&this.template[n(this,s)]===e;)W(this,s)._++;return this.template.slice(a,n(this,s))},De=function(){for(;n(this,s)<this.template.length&&/\s/.test(this.template[n(this,s)]);)W(this,s)._++},ps=function(){return i(this,t,w).call(this,"http://")||i(this,t,w).call(this,"https://")||i(this,t,w).call(this,"//")},ft=function(e){let a=0,r=n(this,s);for(;r<this.template.length&&this.template[r]===e;)a++,r++;return a},ms=function(){const e=n(this,s),a=n(this,s);let r="";for(;n(this,s)<this.template.length;){const _=n(this,s);for(;n(this,s)<this.template.length&&(this.template[n(this,s)]===" "||this.template[n(this,s)]==="	");)W(this,s)._++;if(i(this,t,w).call(this,"> "))i(this,t,H).call(this,"> ");else if(i(this,t,w).call(this,">"))i(this,t,H).call(this,">");else{S(this,s,_);break}const f=i(this,t,se).call(this,p=>p===`
`);if(r+=f,i(this,t,w).call(this,`
`))r+=`
`,i(this,t,H).call(this,`
`);else break}r.endsWith(`
`)&&(r=r.slice(0,-1));const c=new Ce(r).parse();c.forEach(_=>i(this,t,ne).call(this,_,a));const v=n(this,s);return{type:"Blockquote",children:c,start:e,end:v}},se=function(e){let a="";for(;n(this,s)<this.template.length&&!e(this.template[n(this,s)]);)a+=this.template[n(this,s)],W(this,s)._++;return a},ne=function(e,a){e.start+=a,e.end+=a,"children"in e&&Array.isArray(e.children)&&e.children.forEach(r=>i(this,t,ne).call(this,r,a)),"value"in e&&Array.isArray(e.value)&&e.value.forEach(r=>i(this,t,ne).call(this,r,a)),"attributes"in e&&Array.isArray(e.attributes)&&e.attributes.forEach(r=>i(this,t,ne).call(this,r,a)),"text"in e&&Array.isArray(e.text)&&e.text.forEach(r=>i(this,t,ne).call(this,r,a))};let lt=Ce;function ae(o,e){we(e,!0);const a=Y(()=>sn(e.content));var r=L(),l=j(r);qe(l,16,()=>E(a),c=>c,(c,v)=>{zt(c,{get view(){return v}})}),u(o,r),ke()}var nn=q('<div class="spaced"><!></div>'),an=q('<div class="playground svelte-1i3lwl0"><textarea class="svelte-1i3lwl0"></textarea> <div class="preview svelte-1i3lwl0"></div></div>');function rn(o,e){we(e,!0);let r=ot(e,"value",15,`*bold* _italics_ \`code\`

#hashtag and @mention

[markdown link](./markdown-link)

/root/link

./relative/link

network link - //github.com/ryanatkn/end-user-markdown-sketch

<aside>basic safe <a href="https://wikipedia.org/wiki/HTML">html</a> works</aside>

<span class="chip success">class</span> is allowed but <span class="chip" style="color: red">style</span> and most other attributes are not yet - it should support a safe and configurable subset of HTML, not every usecase has the same needs

<button onclick="alert('hax')" title="this button tries to hack you with the onclick attribute but the attribute allowlist disallows it">onclick does not work</button>`);const l=Y(()=>r().split(`
`).filter(Boolean));var c=an(),v=m(c);Os(v);var _=h(v,2);qe(_,21,()=>E(l),Re,(f,p)=>{var g=nn(),y=m(g);ae(y,{get content(){return E(p)}}),d(g),u(f,g)}),d(_),d(c),Ds(v,r),u(o,c),ke()}var on=q('<div class="markdown_text_example panel svelte-6ael15"><!> <!> <p><!></p> <!></div>');function O(o,e){we(e,!0);var a=on(),r=m(a);rt(r,()=>e.children??it);var l=h(r,2);te(l,{get content(){return e.content}});var c=h(l,2),v=m(c);ae(v,{get content(){return e.content}}),d(c);var _=h(c,2);rt(_,()=>e.after??it),d(a),u(o,a),ke()}var ln=q("<p>Element classes are a powerful and safe way for end-users to access the app's styles:</p>"),cn=q("<li><a> </a></li>"),hn=q(`<p>Perhaps an optional Svelte component can be provided for missing components, and
							plaintext is rendered if none is provided.</p>`),dn=q("<p>If a component isn't found, it renders a fallback that preserves the source text:</p>"),un=q(`<main class="width_md svelte-1m5pajl"><div class="width_full"><section class="panel p_md section_xl svelte-1m5pajl"><div class="panel_inner svelte-1m5pajl"><h2 id="motivation" class="svelte-1m5pajl">Motivation</h2> <p>Many social websites provide rich text features to end-users like <!>. Markdown is the common
					name for this markup, although the specifics differ:</p> <ul><li><a href="https://support.discord.com/hc/en-us/articles/210298617-Markdown-Text-101-Chat-Formatting-Bold-Italic-Underline-">Discord Markdown</a></li> <li><a href="https://support.microsoft.com/en-au/office/use-markdown-formatting-in-microsoft-teams-4d10bd65-55e2-4b2d-a1f3-2bebdcd2c772">Teams Markdown</a></li> <li><a href="https://api.slack.com/reference/surfaces/formatting">Slack mrkdwn</a></li></ul> <p>Some platform-independent markdowns include:</p> <ul><li><a href="https://github.github.com/gfm/">GitHub Flavored Markdown</a></li> <li><a href="https://mdsvex.pngwn.io/">MDsveX</a> (this sketch is based on its code)</li> <li><a href="https://djot.net/">djot</a></li> <li><a href="https://commonmark.org/">CommonMark</a></li></ul> <p>There are many markdowns. This project describes a proposed flavor of markdown designed
					for the end-users and developers of an unannounced social app framework. My goal is to
					provide highly flexible and performant capabilities to end-users, not make a new flavor,
					and I would enthusiastically use an existing library if it had the desired features and
					runtime characteristics.</p> <aside>This is a rough sketch from end-user and developer perspectives, not a well-constructed
					spec! See <a href="https://github.com/ryanatkn/end-user-markdown-sketch">the source code</a> for the implementation and credits. The <a href="https://github.com/ryanatkn/end-user-markdown-sketch/discussions">GitHub discussions</a> are enabled if you're interested, and you can <a href="mailto:mail@ryanatkn.com">email me</a> if you would like to keep the discussion private.</aside></div></section> <section class="panel p_md section_xl svelte-1m5pajl"><section class="panel_inner svelte-1m5pajl"><h2 id="key-features" class="svelte-1m5pajl">Key features</h2> <ul><li>customizable - features are optional and exposed through configuation, and rendering is
						pluggable</li> <li>extensible - new features can be added by end-users and developers through
						configuration, using a set of supported syntaxes for cases like @mentions and ~whatever~</li> <li>powerful - renders HTML, *markdownisms*, and a limited form of Svelte components with
						props and composition (no JS/expressions yet but could eventually support all/most of
						Svelte I think?)</li> <li>user-friendly - the default configuration and main Svelte renderer behave more like the
						markdowns of Slack and Discord than traditional dev-friendly markdowns, preserving the
						more common user expectation for newlines and making bold text a single *</li> <li>dev-friendly - renderers like the main HTML/Svelte one may ignore some whitespace but
						parsing+printing any text reproduces it character-for-character, so it's stable to edit
						as data and formatting is off by default, but you can add things like automatic trailing
						whitespace trimming to your UI, if you want</li></ul></section></section> <section class="panel p_md section_xl svelte-1m5pajl"><div class="panel_inner svelte-1m5pajl"><div><h2 id="playground" class="svelte-1m5pajl">Playground</h2> <p>These examples are specific to this context's configuration. Each feature is optional
						and configurable, and the patterns are extensible. See <a href="#extensibility">the extensibility section</a> for more.</p> <br></div> <!> <div><aside>tip: try opening the contextmenu on <!> and <!> and the other <!></aside></div></div></section> <section class="panel p_md section_xl svelte-1m5pajl"><section class="panel_inner svelte-1m5pajl"><h2 id="extensibility" class="svelte-1m5pajl">Extensibility</h2> <p>Almost everything is optional, configurable, or extensible. The goal is to support
					open-ended usecase-specific features, not make a universal markdown.</p> <p>For example, the asterisks for <code>*bold text*</code> are an optional extension
					behavior, so bold could be characters other than <code>*</code>, and its <code>&lt;strong&gt;</code> wrapper is configurable. It could be different HTML or a Svelte
					component.</p> <p>This trades away portability for power and flexibility. It's a huge tradeoff and makes
					this flavor unsuitable for many usecases - it doesn't substitute for existing
					platform-independent markdowns.</p> <p>Some planned extensibility:</p> <ul><li>text wrapped in control characters, like <code>*bold text*</code> and <code>_italics_</code> (probably double character variants too)</li> <li>blocks wrapped in triple control characters, like <code>\`\`\`code blocks\`\`\`</code></li> <li>single words starting with a control character, like <code>@mentions</code> and <code>#hashtags</code></li></ul> <p><a href="#examples">The examples</a> demonstrate extensions with commonly-used control
					characters. Some example control characters include <code>*</code>, <code>_</code>, <code>\`</code>, <code>:</code>, <code>~</code>, <code>%</code>, <code>#</code>, <code>|</code> - any could be supported, including emoji if you want to get 😈weird😈.</p></section></section> <section class="panel p_md section_xl svelte-1m5pajl"><section class="panel_inner svelte-1m5pajl"><h2 id="examples" class="svelte-1m5pajl">Examples</h2> <details><summary>technical details about how these examples work</summary> <p>Each of the following examples mounts a Svelte component named <a href="https://github.com/ryanatkn/end-user-markdown-sketch/blob/main/src/lib/Markdown.svelte"><code>Markdown</code></a> with a <code>content</code> prop:</p> <blockquote><!> <div><!></div></blockquote> <p>The <code>Markdown</code> component internally calls <a href="https://github.com/ryanatkn/end-user-markdown-sketch/blob/main/src/lib/parse_markdown.ts"><code>parse_markdown</code></a> to transform <code>content</code> to its JSON representation, an <a href="https://github.com/estree/estree">ESTree</a>-compliant AST. (and then <a href="https://github.com/ryanatkn/end-user-markdown-sketch/blob/main/src/lib/todo_hacky_parse.ts">some hacky post-processing</a> to demo more features)</p> <p>The @ symbol in <code>hey @you</code> is configured to be interpreted as a shorthand for
						a <a href="https://github.com/ryanatkn/end-user-markdown-sketch/blob/main/src/routes/Mention.svelte"><code>Mention</code></a> component. The text <code>@you</code> is equivalent to <!>. The component is provided by the app and can be anything.</p> <p>The control characters like @ are customizable to enable app-specific features, and they
						could potentially be defined or customized by end-users. (like the people using a chat
						app) <a href="#extensibility">The extensibility section</a> elaborates.</p></details></section> <section class="section_lg svelte-1m5pajl"><h3 id="html-tags">HTML tags</h3> <!> <!></section> <section class="section_lg svelte-1m5pajl"><h3 id="html_attributes">HTML attributes</h3> <p>A safe subset of HTML attributes is supported. Some attributes are sensitive for security
					or privacy, and some contexts need to disallow styles that break the UX.</p> <!> <p>The <code>src</code> and <code>href</code> attributes are enabled here despite having
					security and privacy issues in some contexts. (not here though!) Granular runtime
					configuration including allowlisted hosts is probably desired. Some issues can be handled
					orthogonally with a <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP">Content Security Policy</a>.</p> <!> <!></section> <section class="section_lg svelte-1m5pajl"><h3 id="syntax-sugar">Syntax sugar</h3> <!> <!> <!> <details><summary>TODO</summary> <ul><li>correctly support these across multiple words</li> <li>headers</li> <li>lists, using <code>- this</code> not also <code>* that</code></li> <li><code>\`\`\`code blocks\`\`\`</code> with syntax highlighting</li> <li>resolve backtick-wrapped <!> to a system-defined
							namespace, like an app's vocabulary for contextmenu and other widgety behaviors</li> <li>extensibility</li></ul></details></section> <section class="section_lg svelte-1m5pajl"><h3 id="links">Links</h3> <!> <p><code>/path</code> is a shorthand for <!></p> <!> <p><code>//path</code> is a shorthand for <!></p> <p>The <code>Link</code> component is configurable, and the <code>/</code> and <code>//</code> behaviors are a usecase-specific extension.</p></section> <section class="section_lg svelte-1m5pajl"><h3 id="mentions">Mentions</h3> <!> <p>The <code>@</code> is a shorthand for <!>.</p> <p>The <code>Mention</code> component is configurable, and the <code>@</code> behavior is a usecase-specific
					extension.</p></section> <section class="section_lg svelte-1m5pajl"><h3 id="hashtag">Hashtags</h3> <!> <p>The <code>#</code> is a shorthand for <!>.</p> <p>The <code>Hashtag</code> component is configurable, and the <code>#</code> behavior is a usecase-specific
					extension.</p></section> <section class="svelte-1m5pajl"><h3 id="svelte-components">Svelte components</h3> <aside>⚠️ Svelte component support is specific to my usecases. Maybe the implementation should be
					framework-agnostic, but I'm less interested in that because I'm focused on my end-users.</aside> <p>Tags with capital letters like <code></code> are interpreted as Svelte components.
					Each app chooses which components to provide, and the feature can be disabled by providing
					no components. This example app provides the following components:</p> <ul></ul> <!> <!> <!> <!></section></section> <section class="panel p_md section_xl svelte-1m5pajl"><section class="panel_inner svelte-1m5pajl"><h2 id="discussions" class="svelte-1m5pajl">Discussions</h2> <ul><li><a href="https://github.com/ryanatkn/end-user-markdown-sketch/discussions/2">Questions or comments?</a></li> <li><a href="https://github.com/ryanatkn/end-user-markdown-sketch/discussions/1">Newline behavior</a></li></ul></section></section></div></main>`);function wn(o,e){we(e,!0);const a=Bt.get();var r=un(),l=m(r),c=m(l),v=m(c),_=h(m(v),2),f=h(m(_));ae(f,{content:"*bold* text and @mentions and #hashtags"}),P(),d(_),P(10),d(v),d(c);var p=h(c,4),g=m(p),y=h(m(g),2);rn(y,{});var k=h(y,2),b=m(k),A=h(m(b));ae(A,{content:"@fox"});var T=h(A,2);ae(T,{content:"@dog"});var M=h(T,2);ae(M,{content:"@mentions and #hashtags"}),d(b),d(k),d(g),d(p);var x=h(p,4),F=m(x),C=h(m(F),2),N=h(m(C),4),z=m(N);te(z,{content:'<Markdown content="hey @you" />'});var B=h(z,2),R=m(B);ae(R,{content:"hey @you"}),d(B),d(N);var U=h(N,4),xe=h(m(U),7);te(xe,{content:'<Mention name="you" />',pre_attrs:{style:"display: inline"}}),P(),d(U),P(2),d(C),d(F);var ie=h(F,2),Z=h(m(ie),2);O(Z,{content:"<aside>example HTML tag</aside>"});var Te=h(Z,2);O(Te,{content:`<aside>
	<blockquote>
		<aside>example nesting</aside>
		<details><summary>example summary</summary>hidden details</details>
	</blockquote>
</aside>`}),d(ie);var re=h(ie,2),Me=h(m(re),4),Ve=Y(()=>`export const ALLOWED_HTML_ATTRS = new Set([
	${Array.from(Pt).map(ge=>`'${ge}'`).join(", ")}
]);`);te(Me,{lang:"ts",get content(){return E(Ve)}});var pe=h(Me,4);O(pe,{content:`with class:
<span class="chip">.chip</span>`,children:(ge,de)=>{var ee=ln();u(ge,ee)},$$slots:{default:!0}});var We=h(pe,2);O(We,{content:`safe attributes work:
<img
	src="${Bs}/favicon.png"
	alt="a little yellow spider"
	title="this site's favicon"
	width="128"
	height="128"
	class="pixelated"
/>`}),d(re);var Ae=h(re,2),me=h(m(Ae),2);O(me,{content:"*asterisks* are replaced with a <code>strong</code> tag"});var oe=h(me,2);O(oe,{content:"_underscores_ are replaced with an <code>em</code> tag"});var Le=h(oe,2);O(Le,{content:"`backticks` are replaced with a <code>code</code> tag"});var V=h(Le,2),le=h(m(V),2),je=h(m(le),8),Fe=h(m(je));ae(Fe,{content:"`known_identifiers`"}),P(),d(je),P(2),d(le),d(V),d(Ae);var J=h(Ae,2),Oe=h(m(J),2);O(Oe,{content:"/root link to the current base (like GitHub's flavor, not necessarily absolute to the host!)"});var ce=h(Oe,2),$=h(m(ce),2);te($,{inline:!0,content:'<Link href="{base}/path" />'}),d(ce);var ve=h(ce,2);O(ve,{content:"network link to <code>https:</code> - //github.com/ryanatkn/end-user-markdown-sketch"});var fe=h(ve,2),K=h(m(fe),2);te(K,{inline:!0,content:'<Link href="https://path" />'}),d(fe),P(2),d(J);var he=h(J,2),Ne=h(m(he),2);O(Ne,{content:"@username mentions have contextmenus"});var _e=h(Ne,2),Je=h(m(_e),3);te(Je,{inline:!0,content:'<Mention name="username" />'}),P(),d(_e),P(2),d(he);var Ke=h(he,2),_t=h(m(Ke),2);O(_t,{content:"#hashtags have contextmenus"});var gt=h(_t,2),vs=h(m(gt),3);te(vs,{inline:!0,content:'<Hashtag name="hashtags" />'}),P(),d(gt),P(2),d(Ke);var bt=h(Ke,2),Xe=h(m(bt),4),fs=h(m(Xe));fs.textContent="<This />",P(),d(Xe);var Qe=h(Xe,2);qe(Qe,21,()=>Object.keys(a),Re,(ge,de)=>{var ee=cn(),Se=m(ee),gs=m(Se,!0);d(Se),d(ee),G(()=>{Ns(Se,"href",`https://github.com/ryanatkn/end-user-markdown-sketch/blob/main/src/routes/${E(de)??""}.svelte`),X(gs,E(de))}),u(ge,ee)}),d(Qe);var yt=h(Qe,2);O(yt,{content:'<Link href="/route">this Link</Link> does the same as /route'});var wt=h(yt,2);O(wt,{content:'mentioning <Mention name="username" /> the long way'});var kt=h(wt,2);O(kt,{content:'<Hashtag name="this" /> is equivalent to #this'});var _s=h(kt,2);O(_s,{content:"<Missing /> components are called out",after:de=>{var ee=hn();u(de,ee)},children:(de,ee)=>{var Se=dn();u(de,Se)},$$slots:{after:!0,default:!0}}),d(bt),d(x),P(2),d(l),d(r),u(o,r),ke()}export{wn as component};
